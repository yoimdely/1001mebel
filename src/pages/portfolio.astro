---
import BaseLayout from "../layouts/BaseLayout.astro";
import Section from "../components/ui/Section.astro";
import Button from "../components/ui/Button.astro";
import Breadcrumbs from "../components/Breadcrumbs.astro";
import PortfolioGrid from "../components/PortfolioGrid.astro";
import { portfolioItems, caseStudies } from "../data/portfolio";
import { buildBreadcrumbSchema } from "../lib/schema";

const meta = {
  title: "Наши проекты — мебель на заказ в Сочи",
  description: "Наши проекты мебели на заказ в Сочи: кухни, гардеробные, шкафы и комплексная меблировка новостроек. Работаем по всему Сочи.",
  canonical: "/portfolio"
};

const breadcrumbs = [
  { name: "Главная", url: "/" },
  { name: "Наши проекты", url: "/portfolio" }
];

const schema = [buildBreadcrumbSchema(breadcrumbs)];
const featuredProjects = portfolioItems.slice(0, 6);
---
<BaseLayout {...meta} schema={schema}>
  <Section class="section-sm">
    <span class="eyebrow">Наши проекты</span>
    <h1>Мебель на заказ по всему Сочи</h1>
    <p>Подборка реализованных проектов: кухни, гардеробные, шкафы и комплексная меблировка новостроек.</p>
  </Section>

  <Section class="section-sm">
    <Breadcrumbs items={breadcrumbs} />
  </Section>

  <Section>
    <PortfolioGrid items={featuredProjects} />
    <div class="mt-12 flex flex-wrap items-center gap-4">
      <Button href="/kontakty" variant="secondary">Получить полный каталог</Button>
      <span class="text-muted text-sm">Покажем больше фото по вашему запросу.</span>
    </div>
  </Section>

  <Section class="case-studies">
    <div class="mb-16">
      <span class="eyebrow">Кейсы</span>
      <h2>Проекты для новостроек</h2>
      <p class="text-muted">Показываем, как решаем задачи хранения, планировки и бюджета для новых квартир.</p>
    </div>

    <div class="space-y-24">
      {caseStudies.map((item, i) => (
        <article class="grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-24 items-center">
          <div class={`relative ${i % 2 === 1 ? 'lg:order-2' : ''}`}>
            <div class="aspect-video rounded-lg overflow-hidden shadow-2xl border border-white/5">
              <img src={item.image} alt={item.title} loading="lazy" class="w-full h-full object-cover" />
            </div>
            <div class="absolute -bottom-6 -right-6 lg:-right-10 w-24 h-24 bg-surface-2 border border-white/10 flex items-center justify-center backdrop-blur-md rounded-sm">
              <span class="text-accent font-serif text-xl">0{i + 1}</span>
            </div>
          </div>

          <div class={`${i % 2 === 1 ? 'lg:order-1' : ''}`}>
            <h3 class="font-serif text-3xl md:text-4xl text-white mb-8">{item.title}</h3>

            <div class="space-y-6 mb-12 border-l border-white/10 pl-6">
              <div>
                <span class="text-accent text-xs font-bold uppercase tracking-widest block mb-2">Задача</span>
                <p class="text-muted">{item.task}</p>
              </div>
              <div>
                <span class="text-accent text-xs font-bold uppercase tracking-widest block mb-2">Решение</span>
                <p class="text-muted">{item.solution}</p>
              </div>
              <div>
                <span class="text-accent text-xs font-bold uppercase tracking-widest block mb-2">Материалы</span>
                <p class="text-muted">{item.materials}</p>
              </div>
            </div>

            <div class="flex items-center gap-8 pt-8 border-t border-white/10">
              <div>
                <span class="block text-xs uppercase text-muted tracking-widest mb-1">Срок</span>
                <span class="text-white font-medium">{item.timing}</span>
              </div>
              <div class="w-px h-8 bg-white/10"></div>
              <div>
                <span class="block text-xs uppercase text-muted tracking-widest mb-1">Бюджет</span>
                <span class="text-white font-medium">{item.price}</span>
              </div>
            </div>
          </div>
        </article>
      ))}
    </div>

    <div class="mt-16">
      <Button href="/kontakty" variant="primary">Запросить расчет</Button>
    </div>
  </Section>
</BaseLayout>
